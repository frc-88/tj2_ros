<?xml version="1.0" encoding="UTF-8"?>
<launch>
    <arg name="robot_address" default="10.0.88.2" />
    <arg name="enable_driver_station" value="true" />
    <arg name="map_name" default="$(env ROS_MAP_NAME)" />
    <arg name="robot" default="$(env ROBOT)" />

    <include file="$(find tj2_comm)/launch/tj2_comm.launch">
        <arg name="publish_odom_tf" value="true" />
        <arg name="compact_tf_ids_path"
            value="$(find tj2_bringup)/config/$(arg robot)/frame_ids.yaml" />
    </include>

    <include file="$(find tj2_comm)/launch/twist_mux.launch" />

    <group ns="tj2">
        <include file="$(find ros_networktables_bridge_host)/launch/nt_client.launch">
            <arg name="nt_host" value="$(arg robot_address)" />
        </include>
    </group>

    <include file="$(find tj2_power_mode)/launch/power_mode.launch">
        <arg name="default_power_mode" value="3" />
        <arg name="launch_path" value="$(find tj2_bringup)/launch/diffyjr_power_test_primary.launch" />
    </include>

    <include file="$(find tj2_bringup)/config/$(arg robot)/static_transforms_$(arg robot).launch" />

    <include file="$(find tj2_description)/launch/imu_joint.launch">
        <arg name="camera_imu_topic" value="/tj2_zed/imu/data" />
        <arg name="base_imu_topic" value="/tj2/imu" />
    </include>

    <include file="$(find tj2_description)/launch/tj2_description.launch">
        <arg name="model" value="$(find tj2_description)/urdf/$(arg robot).urdf.xml" />
        <arg name="joint_names" value="$(find tj2_bringup)/config/$(arg robot)/joints.yaml" />
    </include>

    <include file="$(find tj2_match_watcher)/launch/tj2_match_watcher.launch" />

    <include if="$(arg enable_driver_station)"
        file="$(find tj2_driver_station)/launch/tj2_driver_station.launch" />
    <include if="$(arg enable_driver_station)"
        file="$(find tj2_debug_joystick)/launch/tj2_debug_joystick.launch" />

    <include file="$(find tj2_nt_backup)/launch/nt_backup.launch">
        <arg name="nt_host" value="$(arg robot_address)" />
        <arg name="robot" value="$(env ROBOT)" />
    </include>

</launch>